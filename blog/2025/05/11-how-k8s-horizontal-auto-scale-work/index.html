<!DOCTYPE html><html lang="en" data-astro-cid-bvzihdzo> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="sitemap" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" title="BigJoe" href="https://www.joewalker.xzy/rss.xml"><meta name="generator" content="Astro v5.7.4"><!-- Font preloads --><link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://www.joewalker.xzy/blog/2025/05/11-how-k8s-horizontal-auto-scale-work/"><!-- Primary Meta Tags --><title>หลักการ Auto Scale ของ Kubernetes</title><meta name="title" content="หลักการ Auto Scale ของ Kubernetes"><meta name="description" content="หลักการ Auto Scale ของ Kubernetes"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://www.joewalker.xzy/blog/2025/05/11-how-k8s-horizontal-auto-scale-work/"><meta property="og:title" content="หลักการ Auto Scale ของ Kubernetes"><meta property="og:description" content="หลักการ Auto Scale ของ Kubernetes"><meta property="og:image" content="https://www.joewalker.xzy/blog-placeholder-1.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://www.joewalker.xzy/blog/2025/05/11-how-k8s-horizontal-auto-scale-work/"><meta property="twitter:title" content="หลักการ Auto Scale ของ Kubernetes"><meta property="twitter:description" content="หลักการ Auto Scale ของ Kubernetes"><meta property="twitter:image" content="https://www.joewalker.xzy/blog-placeholder-1.jpg"><!-- Google Analytic --><script src="https://www.googletagmanager.com/gtag/js?id=G-72RJB9H4WY"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-72RJB9H4WY');
</script><style>/*! tailwindcss v4.1.4 | MIT License | https://tailwindcss.com */@layer properties{@supports (((-webkit-hyphens:none)) and (not (margin-trim:inline))) or ((-moz-orient:inline) and (not (color:rgb(from red r g b)))){*,:before,:after,::backdrop{--tw-rotate-x:initial;--tw-rotate-y:initial;--tw-rotate-z:initial;--tw-skew-x:initial;--tw-skew-y:initial;--tw-space-y-reverse:0;--tw-border-style:solid;--tw-leading:initial;--tw-font-weight:initial;--tw-shadow:0 0 #0000;--tw-shadow-color:initial;--tw-shadow-alpha:100%;--tw-inset-shadow:0 0 #0000;--tw-inset-shadow-color:initial;--tw-inset-shadow-alpha:100%;--tw-ring-color:initial;--tw-ring-shadow:0 0 #0000;--tw-inset-ring-color:initial;--tw-inset-ring-shadow:0 0 #0000;--tw-ring-inset:initial;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-offset-shadow:0 0 #0000;--tw-outline-style:solid}}}@layer theme{:root,:host{--font-sans:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--font-mono:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--color-blue-600:oklch(54.6% .245 262.881);--color-gray-200:oklch(92.8% .006 264.531);--color-gray-600:oklch(44.6% .03 256.802);--color-gray-700:oklch(37.3% .034 259.733);--color-white:#fff;--spacing:.25rem;--container-xs:20rem;--container-sm:24rem;--text-lg:1.125rem;--text-lg--line-height:calc(1.75/1.125);--text-2xl:1.5rem;--text-2xl--line-height:calc(2/1.5);--font-weight-medium:500;--font-weight-bold:700;--leading-relaxed:1.625;--radius-md:.375rem;--default-transition-duration:.15s;--default-transition-timing-function:cubic-bezier(.4,0,.2,1);--default-font-family:var(--font-sans);--default-mono-font-family:var(--font-mono)}}@layer base{*,:after,:before,::backdrop{box-sizing:border-box;border:0 solid;margin:0;padding:0}::file-selector-button{box-sizing:border-box;border:0 solid;margin:0;padding:0}html,:host{-webkit-text-size-adjust:100%;tab-size:4;line-height:1.5;font-family:var(--default-font-family,ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji");font-feature-settings:var(--default-font-feature-settings,normal);font-variation-settings:var(--default-font-variation-settings,normal);-webkit-tap-highlight-color:transparent}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;-webkit-text-decoration:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:var(--default-mono-font-family,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace);font-feature-settings:var(--default-mono-font-feature-settings,normal);font-variation-settings:var(--default-mono-font-variation-settings,normal);font-size:1em}small{font-size:80%}sub,sup{vertical-align:baseline;font-size:75%;line-height:0;position:relative}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}:-moz-focusring{outline:auto}progress{vertical-align:baseline}summary{display:list-item}ol,ul,menu{list-style:none}img,svg,video,canvas,audio,iframe,embed,object{vertical-align:middle;display:block}img,video{max-width:100%;height:auto}button,input,select,optgroup,textarea{font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;color:inherit;opacity:1;background-color:#0000;border-radius:0}::file-selector-button{font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;color:inherit;opacity:1;background-color:#0000;border-radius:0}:where(select:is([multiple],[size])) optgroup{font-weight:bolder}:where(select:is([multiple],[size])) optgroup option{padding-inline-start:20px}::file-selector-button{margin-inline-end:4px}::placeholder{opacity:1}@supports (not ((-webkit-appearance:-apple-pay-button))) or (contain-intrinsic-size:1px){::placeholder{color:currentColor}@supports (color:color-mix(in lab,red,red)){::placeholder{color:color-mix(in oklab,currentcolor 50%,transparent)}}}textarea{resize:vertical}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-date-and-time-value{min-height:1lh;text-align:inherit}::-webkit-datetime-edit{display:inline-flex}::-webkit-datetime-edit-fields-wrapper{padding:0}::-webkit-datetime-edit{padding-block:0}::-webkit-datetime-edit-year-field{padding-block:0}::-webkit-datetime-edit-month-field{padding-block:0}::-webkit-datetime-edit-day-field{padding-block:0}::-webkit-datetime-edit-hour-field{padding-block:0}::-webkit-datetime-edit-minute-field{padding-block:0}::-webkit-datetime-edit-second-field{padding-block:0}::-webkit-datetime-edit-millisecond-field{padding-block:0}::-webkit-datetime-edit-meridiem-field{padding-block:0}:-moz-ui-invalid{box-shadow:none}button,input:where([type=button],[type=reset],[type=submit]){appearance:button}::file-selector-button{appearance:button}::-webkit-inner-spin-button{height:auto}::-webkit-outer-spin-button{height:auto}[hidden]:where(:not([hidden=until-found])){display:none!important}}@layer components;@layer utilities{.invisible{visibility:hidden}.absolute{position:absolute}.fixed{position:fixed}.relative{position:relative}.static{position:static}.inset-0{inset:calc(var(--spacing)*0)}.isolate{isolation:isolate}.container{width:100%}@media (min-width:40rem){.container{max-width:40rem}}@media (min-width:48rem){.container{max-width:48rem}}@media (min-width:64rem){.container{max-width:64rem}}@media (min-width:80rem){.container{max-width:80rem}}@media (min-width:96rem){.container{max-width:96rem}}.m-2{margin:calc(var(--spacing)*2)}.m-26{margin:calc(var(--spacing)*26)}.m-30{margin:calc(var(--spacing)*30)}.m-42{margin:calc(var(--spacing)*42)}.m-50{margin:calc(var(--spacing)*50)}.m-51{margin:calc(var(--spacing)*51)}.m-70{margin:calc(var(--spacing)*70)}.m-76{margin:calc(var(--spacing)*76)}.m-77{margin:calc(var(--spacing)*77)}.m-88{margin:calc(var(--spacing)*88)}.m-94{margin:calc(var(--spacing)*94)}.m-138{margin:calc(var(--spacing)*138)}.m-148{margin:calc(var(--spacing)*148)}.m-155{margin:calc(var(--spacing)*155)}.m-195{margin:calc(var(--spacing)*195)}.m-260{margin:calc(var(--spacing)*260)}.m-307{margin:calc(var(--spacing)*307)}.m-1886{margin:calc(var(--spacing)*1886)}.m-2029{margin:calc(var(--spacing)*2029)}.m-2530{margin:calc(var(--spacing)*2530)}.m-2869{margin:calc(var(--spacing)*2869)}.mt-1{margin-top:calc(var(--spacing)*1)}.mt-8{margin-top:calc(var(--spacing)*8)}.mb-2{margin-bottom:calc(var(--spacing)*2)}.contents{display:contents}.flex{display:flex}.grid{display:grid}.inline-block{display:inline-block}.table{display:table}.h-4{height:calc(var(--spacing)*4)}.h-64{height:calc(var(--spacing)*64)}.min-h-screen{min-height:100vh}.w-4{width:calc(var(--spacing)*4)}.w-full{width:100%}.max-w-sm{max-width:var(--container-sm)}.flex-1{flex:1}.flex-grow{flex-grow:1}.transform{transform:var(--tw-rotate-x,)var(--tw-rotate-y,)var(--tw-rotate-z,)var(--tw-skew-x,)var(--tw-skew-y,)}.resize{resize:both}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-between{justify-content:space-between}.justify-end{justify-content:flex-end}.justify-items-center{justify-items:center}.gap-4{gap:calc(var(--spacing)*4)}.gap-8{gap:calc(var(--spacing)*8)}:where(.space-y-1>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*1)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*1)*calc(1 - var(--tw-space-y-reverse)))}.overflow-hidden{overflow:hidden}.rounded{border-radius:.25rem}.rounded-md{border-radius:var(--radius-md)}.border{border-style:var(--tw-border-style);border-width:1px}.border-t{border-top-style:var(--tw-border-style);border-top-width:1px}.border-b{border-bottom-style:var(--tw-border-style);border-bottom-width:1px}.border-gray-200{border-color:var(--color-gray-200)}.bg-gray-200{background-color:var(--color-gray-200)}.object-cover{object-fit:cover}.p-3{padding:calc(var(--spacing)*3)}.p-4{padding:calc(var(--spacing)*4)}.p-6{padding:calc(var(--spacing)*6)}.px-3{padding-inline:calc(var(--spacing)*3)}.py-1{padding-block:calc(var(--spacing)*1)}.py-4{padding-block:calc(var(--spacing)*4)}.py-6{padding-block:calc(var(--spacing)*6)}.pl-6{padding-left:calc(var(--spacing)*6)}.text-left{text-align:left}.text-right{text-align:right}.text-2xl{font-size:var(--text-2xl);line-height:var(--tw-leading,var(--text-2xl--line-height))}.text-lg{font-size:var(--text-lg);line-height:var(--tw-leading,var(--text-lg--line-height))}.leading-relaxed{--tw-leading:var(--leading-relaxed);line-height:var(--leading-relaxed)}.font-bold{--tw-font-weight:var(--font-weight-bold);font-weight:var(--font-weight-bold)}.font-medium{--tw-font-weight:var(--font-weight-medium);font-weight:var(--font-weight-medium)}.text-blue-600{color:var(--color-blue-600)}.text-gray-600{color:var(--color-gray-600)}.text-gray-700{color:var(--color-gray-700)}.text-white{color:var(--color-white)}.shadow-lg{--tw-shadow:0 10px 15px -3px var(--tw-shadow-color,#0000001a),0 4px 6px -4px var(--tw-shadow-color,#0000001a);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.outline{outline-style:var(--tw-outline-style);outline-width:1px}.transition{transition-property:color,background-color,border-color,outline-color,text-decoration-color,fill,stroke,--tw-gradient-from,--tw-gradient-via,--tw-gradient-to,opacity,box-shadow,transform,translate,scale,rotate,filter,-webkit-backdrop-filter,backdrop-filter;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration))}.transition-colors{transition-property:color,background-color,border-color,outline-color,text-decoration-color,fill,stroke,--tw-gradient-from,--tw-gradient-via,--tw-gradient-to;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration))}.transition-transform{transition-property:transform,translate,scale,rotate;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration))}@media (hover:hover){.hover\:border-blue-600:hover{border-color:var(--color-blue-600)}.hover\:bg-gray-200:hover{background-color:var(--color-gray-200)}}@media (min-width:48rem){.md\:w-xs{width:var(--container-xs)}.md\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.md\:flex-row{flex-direction:row}.md\:border-r-2{border-right-style:var(--tw-border-style);border-right-width:2px}.md\:border-b-0{border-bottom-style:var(--tw-border-style);border-bottom-width:0}}@media (min-width:64rem){.lg\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}}}:root{--accent:#2337ff;--accent-dark:#000d8a;--black:15,18,25;--gray:96,115,159;--gray-light:229,233,240;--gray-dark:34,41,57;--gray-gradient:rgba(var(--gray-light),50%),#fff;--green-50:#f0fdf4;--green-100:#dcfce7;--green-200:#bbf7d0;--blue-50:#eff6ff;--blue-100:#dbeafe;--blue-200:#bfdbfe;--box-shadow:0 2px 6px rgba(var(--gray),25%),0 8px 24px rgba(var(--gray),33%),0 16px 32px rgba(var(--gray),33%)}@font-face{font-family:Atkinson;src:url(/fonts/atkinson-regular.woff)format("woff");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:Atkinson;src:url(/fonts/atkinson-bold.woff)format("woff");font-weight:700;font-style:normal;font-display:swap}body{text-align:left;background:linear-gradient(var(--gray-gradient))no-repeat;word-wrap:break-word;overflow-wrap:break-word;color:rgb(var(--gray-dark));background-size:100% 600px;margin:0;padding:0;font-family:Atkinson,sans-serif;font-size:20px;line-height:1.7}main{width:720px;max-width:calc(100% - 2em);margin:auto;padding:3em 1em}h1,h2,h3,h4,h5,h6{color:rgb(var(--black));margin:0 0 .5rem;line-height:1.2}h1{font-size:3.052em}h2{font-size:2.441em}h3{font-size:1.953em}h4{font-size:1.563em}h5{font-size:1.25em}strong,b{font-weight:700}a,a:hover{color:var(--accent)}p{margin-bottom:1em}p:has(+ul),p:has(+pre),ul li p{margin-bottom:0}ol:has(+blockquote),ul:has(+blockquote),.prose ol:has(+p),.prose ul:has(+p){margin-bottom:1em}.prose p:has(+ol,ul){margin-bottom:0}.prose ol,ul{padding-left:1.5em;list-style-type:disc}.prose ul ul{padding-left:1.5em;list-style-type:circle}textarea{width:100%;font-size:16px}input{font-size:16px}table{width:100%;margin-bottom:1em}table thead tr{background-color:rgba(var(--gray-light),50%)}table thead tr th{border-radius:3px;padding:.5rem}table tbody tr:not(:last-child){border-bottom:1px solid rgba(var(--gray-light),80%)}table tbody tr td{padding:.5rem}img{border-radius:8px;max-width:100%;height:auto;max-height:510px}code{background-color:var(--blue-50);border-radius:2px;padding:2px 5px}pre{border-radius:8px;padding:1.5em;white-space:pre!important}pre>code{all:unset;font-size:16px}blockquote{border-left:4px solid var(--accent);margin:0;padding:0 0 0 20px;font-size:1.333em}hr{border:none;border-top:1px solid rgb(var(--gray-light))}svg[role="graphics-document document"]{justify-self:center;margin-bottom:1em}@media (max-width:720px){body{font-size:18px}main{padding:1em 0}p{text-align:justify}.line.diff.remove,.line.diff.add{padding:4px 8px 8px!important}.prose{max-width:100%!important;margin:0!important}}.line.diff.remove{background-color:#f7cccc1a;padding:7px 8px 8px;line-height:0}.line.diff.add{background-color:#00ff001a;padding:7px 8px 8px;line-height:0}.sr-only{clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px);clip-path:inset(50%);white-space:nowrap;border:0;width:1px;height:1px;margin:0;padding:0;overflow:hidden;position:absolute!important}@property --tw-rotate-x{syntax:"*";inherits:false}@property --tw-rotate-y{syntax:"*";inherits:false}@property --tw-rotate-z{syntax:"*";inherits:false}@property --tw-skew-x{syntax:"*";inherits:false}@property --tw-skew-y{syntax:"*";inherits:false}@property --tw-space-y-reverse{syntax:"*";inherits:false;initial-value:0}@property --tw-border-style{syntax:"*";inherits:false;initial-value:solid}@property --tw-leading{syntax:"*";inherits:false}@property --tw-font-weight{syntax:"*";inherits:false}@property --tw-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-shadow-color{syntax:"*";inherits:false}@property --tw-shadow-alpha{syntax:"<percentage>";inherits:false;initial-value:100%}@property --tw-inset-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-inset-shadow-color{syntax:"*";inherits:false}@property --tw-inset-shadow-alpha{syntax:"<percentage>";inherits:false;initial-value:100%}@property --tw-ring-color{syntax:"*";inherits:false}@property --tw-ring-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-inset-ring-color{syntax:"*";inherits:false}@property --tw-inset-ring-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-ring-inset{syntax:"*";inherits:false}@property --tw-ring-offset-width{syntax:"<length>";inherits:false;initial-value:0}@property --tw-ring-offset-color{syntax:"*";inherits:false;initial-value:#fff}@property --tw-ring-offset-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-outline-style{syntax:"*";inherits:false;initial-value:solid}a[data-astro-cid-eimmu3lg]{display:inline-block;text-decoration:none}a[data-astro-cid-eimmu3lg].active{font-weight:bolder;text-decoration:underline}header[data-astro-cid-3ef6ksr2]{margin:0;padding:0 1em;background:#fff;box-shadow:0 2px 8px rgba(var(--black),5%)}h2[data-astro-cid-3ef6ksr2]{margin:0;font-size:1em}h2[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2],h2[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2].active{text-decoration:none}nav[data-astro-cid-3ef6ksr2]{display:flex;align-items:center;justify-content:space-between}nav[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{padding:1em .5em;color:var(--black);border-bottom:4px solid transparent;text-decoration:none}nav[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2].active{text-decoration:none;border-bottom-color:var(--accent)}.social-links[data-astro-cid-3ef6ksr2],.social-links[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{display:flex;justify-content:center;align-items:center}@media (max-width: 720px){.social-links[data-astro-cid-3ef6ksr2]{display:none}}.navbar-logo[data-astro-cid-3ef6ksr2]{display:flex;justify-content:center;align-items:center}footer[data-astro-cid-sz7xmlte]{padding:2em 1em 6em;background:linear-gradient(var(--gray-gradient)) no-repeat;color:rgb(var(--gray));text-align:center}.social-links[data-astro-cid-sz7xmlte]{display:flex;justify-content:center;gap:1em;margin-top:1em}.social-links[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]{text-decoration:none;color:rgb(var(--gray))}.social-links[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]:hover{color:rgb(var(--gray-dark))}main[data-astro-cid-bvzihdzo]{width:calc(100% - 2em);max-width:100%;margin:auto}.hero-image[data-astro-cid-bvzihdzo]{width:100%}.hero-image[data-astro-cid-bvzihdzo] img[data-astro-cid-bvzihdzo]{display:block;margin:0 auto;border-radius:12px;box-shadow:var(--box-shadow)}.prose[data-astro-cid-bvzihdzo]{width:56rem;max-width:calc(100% - 2em);margin:auto;padding:1em;color:rgb(var(--gray-dark))}.title[data-astro-cid-bvzihdzo]{margin-bottom:1em;padding:1em 0;text-align:center;line-height:1}.title[data-astro-cid-bvzihdzo] h1[data-astro-cid-bvzihdzo]{margin:0 0 .5em}.date[data-astro-cid-bvzihdzo]{margin-bottom:.5em;color:rgb(var(--gray))}.last-updated-on[data-astro-cid-bvzihdzo]{font-style:italic}main[data-astro-cid-5tznm7mj]{width:960px}ul[data-astro-cid-5tznm7mj]{display:flex;flex-wrap:wrap;gap:2rem;list-style-type:none;margin:0;padding:0}ul[data-astro-cid-5tznm7mj] li[data-astro-cid-5tznm7mj]{width:calc(50% - 1rem)}ul[data-astro-cid-5tznm7mj] li[data-astro-cid-5tznm7mj] [data-astro-cid-5tznm7mj]{text-decoration:none;transition:.2s ease}ul[data-astro-cid-5tznm7mj] li[data-astro-cid-5tznm7mj]:first-child{width:100%;margin-bottom:1rem;text-align:center}ul[data-astro-cid-5tznm7mj] li[data-astro-cid-5tznm7mj]:first-child img[data-astro-cid-5tznm7mj]{width:100%}ul[data-astro-cid-5tznm7mj] li[data-astro-cid-5tznm7mj]:first-child .title[data-astro-cid-5tznm7mj]{font-size:2.369rem}ul[data-astro-cid-5tznm7mj] li[data-astro-cid-5tznm7mj] img[data-astro-cid-5tznm7mj]{margin-bottom:1.5rem;border-radius:12px}ul[data-astro-cid-5tznm7mj] li[data-astro-cid-5tznm7mj] a[data-astro-cid-5tznm7mj]{display:block}.title[data-astro-cid-5tznm7mj]{margin:0;color:rgb(var(--black));line-height:1.3}.date[data-astro-cid-5tznm7mj]{margin:0;color:rgb(var(--gray))}ul[data-astro-cid-5tznm7mj] li[data-astro-cid-5tznm7mj] a[data-astro-cid-5tznm7mj]:hover h4[data-astro-cid-5tznm7mj],ul[data-astro-cid-5tznm7mj] li[data-astro-cid-5tznm7mj] a[data-astro-cid-5tznm7mj]:hover .date[data-astro-cid-5tznm7mj]{color:rgb(var(--accent))}ul[data-astro-cid-5tznm7mj] a[data-astro-cid-5tznm7mj]:hover img[data-astro-cid-5tznm7mj]{box-shadow:var(--box-shadow)}ul[data-astro-cid-5tznm7mj] li[data-astro-cid-5tznm7mj]:not(:first-child) img[data-astro-cid-5tznm7mj]{height:240px}@media (max-width: 720px){ul[data-astro-cid-5tznm7mj]{gap:.5em}ul[data-astro-cid-5tznm7mj] li[data-astro-cid-5tznm7mj]{width:100%;text-align:center}ul[data-astro-cid-5tznm7mj] li[data-astro-cid-5tznm7mj]:first-child{margin-bottom:0}ul[data-astro-cid-5tznm7mj] li[data-astro-cid-5tznm7mj]:first-child .title[data-astro-cid-5tznm7mj]{font-size:1.563em}}main[data-astro-cid-2iqln3bm]{width:calc(100% - 2em);max-width:100%;margin:0}ul[data-astro-cid-2iqln3bm]{list-style-type:disc;padding-left:1.5em}ul[data-astro-cid-2iqln3bm] ul[data-astro-cid-2iqln3bm],ul[data-astro-cid-2iqln3bm] ul[data-astro-cid-2iqln3bm] ul[data-astro-cid-2iqln3bm]{list-style-type:circle}.hero-image[data-astro-cid-2iqln3bm]{width:100%}.hero-image[data-astro-cid-2iqln3bm] img[data-astro-cid-2iqln3bm]{display:block;margin:0 auto;border-radius:12px;box-shadow:var(--box-shadow)}.prose[data-astro-cid-2iqln3bm]{width:56rem;max-width:calc(100% - 2em);margin:auto;padding:1em;color:rgb(var(--gray-dark))}.title[data-astro-cid-2iqln3bm]{margin-bottom:1em;padding:1em 0;text-align:center;line-height:1}.title[data-astro-cid-2iqln3bm] h1[data-astro-cid-2iqln3bm]{margin:0 0 .5em}.date[data-astro-cid-2iqln3bm]{margin-bottom:.5em;color:rgb(var(--gray))}.last-updated-on[data-astro-cid-2iqln3bm]{font-style:italic}a[data-astro-cid-jwgesljd],a[data-astro-cid-jwgesljd]:hover{color:#4a5565}
</style></head> <body data-astro-cid-bvzihdzo> <header data-astro-cid-3ef6ksr2> <nav data-astro-cid-3ef6ksr2> <h2 class="navbar-logo" data-astro-cid-3ef6ksr2> <img width="40" height="40" src="/logo.png" alt="" data-astro-cid-3ef6ksr2> <a href="/" class="font-bold text-2xl" data-astro-cid-3ef6ksr2>BigJoe</a> </h2> <div class="internal-links" data-astro-cid-3ef6ksr2> <a href="/" class="active" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Blog </a>  <a href="/book" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Book </a>  </div> <div class="social-links" data-astro-cid-3ef6ksr2> <a href="https://www.facebook.com/profile.php?id=61572916280350" target="_blank" data-astro-cid-3ef6ksr2> <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" data-astro-cid-3ef6ksr2> <path fill="currentColor" d="M13.458 21.696c4.693-.704 8.292-4.753 8.292-9.642c0-5.385-4.365-9.75-9.75-9.75s-9.75 4.365-9.75 9.75c0 4.89 3.599 8.938 8.292 9.642v-6.798h-2.05a.486.486 0 0 1-.486-.486v-1.843c0-.269.218-.486.486-.486h2.05l-.072-1.943c0-.942.175-2.471 1.342-3.307c.816-.583 1.423-.693 2.397-.693c.845 0 1.426.084 1.81.14l.188.025a.193.193 0 0 1 .168.192v2.04c0 .113-.095.2-.205.194h-.038c-.114.004-.71.029-1.216.029c-.89 0-1.458.406-1.458 1.755v1.568h2.192c.3 0 .529.27.48.566l-.28 1.843a.486.486 0 0 1-.479.406h-1.913z" data-astro-cid-3ef6ksr2></path> </svg> </a> <a href="https://x.com/joewalker_xyz" target="_blank" data-astro-cid-3ef6ksr2> <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" data-astro-cid-3ef6ksr2> <g fill="none" fill-rule="evenodd" data-astro-cid-3ef6ksr2> <path d="m12.594 23.258l-.012.002l-.071.035l-.02.004l-.014-.004l-.071-.036q-.016-.004-.024.006l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.016-.018m.264-.113l-.014.002l-.184.093l-.01.01l-.003.011l.018.43l.005.012l.008.008l.201.092q.019.005.029-.008l.004-.014l-.034-.614q-.005-.019-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.003-.011l.018-.43l-.003-.012l-.01-.01z" data-astro-cid-3ef6ksr2></path> <path fill="currentColor" d="M19.753 4.659a1 1 0 0 0-1.506-1.317l-5.11 5.84L8.8 3.4A1 1 0 0 0 8 3H4a1 1 0 0 0-.8 1.6l6.437 8.582l-5.39 6.16a1 1 0 0 0 1.506 1.317l5.11-5.841L15.2 20.6a1 1 0 0 0 .8.4h4a1 1 0 0 0 .8-1.6l-6.437-8.582l5.39-6.16ZM16.5 19L6 5h1.5L18 19z" data-astro-cid-3ef6ksr2></path> </g> </svg> </a> <a href="https://github.com/joeteerawit" target="_blank" data-astro-cid-3ef6ksr2> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" data-astro-cid-3ef6ksr2><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-3ef6ksr2></path></svg> </a> </div> </nav> </header>  <main data-astro-cid-bvzihdzo> <article data-astro-cid-bvzihdzo> <div class="hero-image" data-astro-cid-bvzihdzo> <img width="1020" height="510" src="/2025/05/d5236f09-04cc-44a0-bd31-2c63b21bc834.png" alt="" data-astro-cid-bvzihdzo> </div> <div class="prose" data-astro-cid-bvzihdzo> <div class="title" data-astro-cid-bvzihdzo> <div class="date" data-astro-cid-bvzihdzo> <time datetime="2025-05-11T00:00:00.000Z"> May 11, 2025 </time>  </div> <h1 data-astro-cid-bvzihdzo>หลักการ Auto Scale ของ Kubernetes</h1> <hr data-astro-cid-bvzihdzo> </div>  <h2 id="horizontal-pod-autoscaling">Horizontal Pod Autoscaling</h2>
<p>ใน Kubernetes เนี่ย มีของที่เรียกว่า <strong>HorizontalPodAutoscaler</strong> หรือเรียกสั้น ๆ ว่า HPA มันจะคอยปรับพวก workload resource (เช่น Deployment หรือ StatefulSet) แบบอัตโนมัติ เพื่อให้ระบบสามารถ <strong>scale ตามความต้องการใช้งานจริง</strong></p>
<p>คำว่า <strong>horizontal scaling</strong> ก็คือการรับมือกับโหลดที่เพิ่มขึ้นด้วยการ <strong>เพิ่มจำนวน Pod</strong> เข้าไป
อันนี้ต่างจาก <strong>vertical scaling</strong> ที่เป็นการเพิ่ม resource (เช่น CPU หรือ memory) ให้กับ Pod เดิมที่กำลังรันอยู่</p>
<p>ถ้าโหลดลดลง แล้วจำนวน Pod เกินค่าต่ำสุดที่เรากำหนดไว้ HPA ก็จะสั่งให้ resource ที่ดูแลอยู่ (เช่น Deployment หรือ StatefulSet) <strong>ลดจำนวน Pod ลง</strong></p>
<p>แต่ต้องบอกก่อนว่า HPA จะไม่ทำงานกับ object ที่ <strong>scale ไม่ได้</strong> เช่น <strong>DaemonSet</strong> นะ</p>
<p>จริง ๆ แล้ว HPA มันถูกสร้างเป็นทั้ง <strong>Kubernetes API resource</strong> และ <strong>controller</strong> ที่รันอยู่ใน control plane
Resource จะกำหนดว่า controller ต้องทำงานยังไง
ส่วนตัว controller เองมันจะคอยดู metric ต่าง ๆ เช่น <strong>average CPU utilization</strong>, <strong>average memory usage</strong> หรือแม้แต่ <strong>custom metric</strong> ที่เราตั้งเอง แล้วค่อย ๆ ปรับ scale ให้เหมาะกับสถานการณ์</p>
<h2 id="horizontalpodautoscaler-ทำงานยังไง">HorizontalPodAutoscaler ทำงานยังไง?</h2>
<p>Figure 1: HorizontalPodAutoscaler คุม scale ของ Deployment และ ReplicaSet</p>
<p>Kubernetes ใช้กลไกของ <strong>horizontal pod autoscaling</strong> เป็น <strong>control loop</strong> ที่รันแบบเป็นช่วง ๆ (ไม่ได้รันตลอดเวลา)
ช่วงเวลาที่มันจะ sync แต่ละครั้ง ถูกตั้งค่าไว้ด้วย <code>--horizontal-pod-autoscaler-sync-period</code> ใน <code>kube-controller-manager</code>
(โดย default จะ sync ทุก ๆ 15 วินาที)</p>
<p>ในแต่ละรอบที่รัน controller manager จะไปเช็คการใช้งาน resource (resource utilization) โดยอิงจาก metric ที่ระบุไว้ใน HPA แต่ละตัว
มันจะไปหาว่า HPA นั้นกำลัง target resource อะไร (ผ่าน <code>scaleTargetRef</code>) แล้วดูว่า Pod ไหนบ้างที่เกี่ยวข้อง จาก <code>.spec.selector</code> ของ resource นั้น
จากนั้นก็ไปดึง metric มาจาก <strong>resource metrics API</strong> (ถ้าเป็น per-pod metric อย่าง CPU) หรือ <strong>custom metrics API</strong> (ถ้าเป็น metric แบบอื่น)</p>
<p>ถ้าเป็น <strong>per-pod resource metric</strong> (เช่น CPU) controller จะไปดึง metric จาก resource metrics API ของแต่ละ Pod ที่อยู่ใน scope ของ HPA
ถ้ามีตั้ง <strong>target utilization</strong> ไว้ มันก็จะคำนวณออกมาเป็น percentage ของ resource request ที่ container ใน Pod นั้นใช้
แต่ถ้าตั้งเป็น <strong>target raw value</strong> ไว้ มันก็จะใช้ค่าจริง ๆ (raw metric) ตรง ๆ เลย
จากนั้น controller จะเอาค่าเฉลี่ยของ utilization หรือ raw value (แล้วแต่กรณี) มาหา <strong>ratio</strong> เพื่อใช้ในการคำนวณว่าจะต้อง scale เป็นกี่ replica</p>
<p><strong>ข้อควรระวัง:</strong> ถ้า container บางตัวใน Pod <strong>ไม่ได้กำหนด resource request ไว้เลย</strong> เช่น CPU utilization ก็จะไม่สามารถคำนวณได้ และ autoscaler ก็จะไม่ทำอะไรกับ metric นั้น</p>
<p>ถ้าเป็น <strong>per-pod custom metric</strong> controller ก็จะทำงานคล้ายกันกับ per-pod resource metric เลย แต่จะใช้ <strong>raw value ตรง ๆ</strong> แทนการแปลงเป็น percentage</p>
<p>ส่วน <strong>object metrics</strong> หรือ <strong>external metrics</strong> จะมี metric แค่ตัวเดียวที่อธิบาย object นั้น ๆ แล้วจะเอาไปเทียบกับ target value เพื่อคำนวณ ratio เหมือนกัน
(ถ้าใช้ autoscaling API version v2 ก็สามารถตั้งให้หารด้วยจำนวน Pod ก่อนจะเทียบได้ด้วย)</p>
<p>การใช้งานทั่วไปของ HPA คือการตั้งให้ไปดึง metric จากพวก <strong>aggregated APIs</strong> อย่าง</p>
<ul>
<li><code>metrics.k8s.io</code></li>
<li><code>custom.metrics.k8s.io</code></li>
<li><code>external.metrics.k8s.io</code></li>
</ul>
<p>โดย <code>metrics.k8s.io</code> จะมาจาก <strong>Metrics Server</strong> ซึ่งต้องติดตั้งแยกต่างหาก (ไม่มาพร้อมกับ Kubernetes)</p>
<p>API เหล่านี้ก็จะมี <strong>ระดับความเสถียร (stability)</strong> และ <strong>สถานะการซัพพอร์ต (support status)</strong> ที่ต่างกันไป ซึ่ง API documentation ก็จะอธิบายไว้ชัด</p>
<p>ตัว HPA controller เองจะเข้าถึง resource ที่สามารถ scale ได้ เช่น <strong>Deployment</strong> หรือ <strong>StatefulSet</strong>
resource เหล่านี้จะมี <strong>subresource</strong> ที่ชื่อว่า <code>scale</code> ซึ่งเป็น interface สำหรับกำหนดจำนวน replica แบบ dynamic ได้</p>
<h3 id="รายละเอียดของ-algorithm-ที่ใช้ใน-horizontalpodautoscaler">รายละเอียดของ Algorithm ที่ใช้ใน HorizontalPodAutoscaler</h3>
<p>โดยพื้นฐานเลยนะ ตัว controller ของ HPA จะใช้สูตรคำนวณจาก <strong>อัตราส่วน (ratio)</strong> ระหว่างค่า metric ที่ต้องการ กับค่าที่เป็นอยู่ตอนนี้:</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span>desiredReplicas = ceil(currentReplicas × currentMetricValue / desiredMetricValue)</span></span></code></pre>
<p><strong>เช่น:</strong>
ถ้าตอนนี้ metric เป็น <code>200m</code> แล้ว target คือ <code>100m</code> → จะได้ 200 ÷ 100 = <strong>2.0</strong> → ก็จะ scale เพิ่มขึ้นเป็น <strong>2 เท่า</strong>
แต่ถ้า metric เป็น <code>50m</code> แทน → ก็จะได้ 50 ÷ 100 = <strong>0.5</strong> → scale ลดลงครึ่งนึง
<strong>แต่ถ้า ratio ใกล้ 1.0 มาก (โดย default คือ ±0.1)</strong> HPA จะ <strong>ไม่ scale อะไรเลย</strong> (เพื่อหลีกเลี่ยงการแกว่งของจำนวน Pod ที่ไม่จำเป็น)</p>
<h3 id="การคำนวณ-metric">การคำนวณ metric</h3>
<p>ถ้าตั้งพวก <code>targetAverageValue</code> หรือ <code>targetAverageUtilization</code> ไว้
ระบบจะไปเอา metric จากทุก Pod ใน scope ของ HPA มาหาค่าเฉลี่ย → นั่นแหละคือ <code>currentMetricValue</code></p>
<p>ก่อนจะตัดสินใจ scale หรือไม่ scale ระบบจะเช็คด้วยว่า</p>
<ul>
<li>metric ของ Pod ไหนขาดหายมั้ย</li>
<li>Pod ไหน <strong>Ready</strong> บ้าง</li>
<li>Pod ไหนกำลังจะถูกลบ (<code>deletionTimestamp</code> ตั้งไว้แล้ว) หรือ fail → พวกนี้จะไม่เอามาคิด</li>
</ul>
<p>ถ้า Pod ไหนยังไม่มี metric หรือยังไม่ Ready → จะถูก “พักไว้ก่อน” (set aside) แล้วค่อยมาคิดตอนท้าย</p>
<h3 id="กรณี-cpu-ยังไม่-ready">กรณี CPU ยังไม่ Ready</h3>
<p>เวลา scale จาก CPU metric ถ้า Pod ไหนยังไม่ Ready (กำลัง start อยู่ หรือ unhealthy)
หรือ metric ล่าสุดมาหลังจากที่ Pod ยังไม่พร้อม → จะไม่เอาค่านั้นมาใช้ทันที</p>
<p>Kubernetes เองก็มีข้อจำกัด มันไม่รู้เป๊ะ ๆ ว่า Pod ไหน Ready ครั้งแรกเมื่อไหร่
เลยต้องใช้วิธีประมาณเอา:</p>
<ul>
<li>ถ้า Pod ยังไม่ Ready และเพิ่ง Ready ไม่นาน (ภายใน <code>--horizontal-pod-autoscaler-initial-readiness-delay</code>, default: 30 วินาที) → ถือว่า “ยังไม่ Ready”</li>
<li>หลังจาก Ready ไปแล้ว ถ้ามีการ Ready ใหม่ภายในช่วง <code>--horizontal-pod-autoscaler-cpu-initialization-period</code> (default: 5 นาที) → ก็ถือว่าเป็น Ready แรก</li>
</ul>
<h3 id="พอรู้ว่า-pod-ไหนใช้ได้บ้างแล้ว">พอรู้ว่า Pod ไหนใช้ได้บ้างแล้ว…</h3>
<p>เราก็จะใช้พวก Pod ที่ผ่านการคัดกรองข้างบนมาคิด ratio จริง ๆ
ถ้ามี metric หาย ระบบจะ <strong>คิดแบบระมัดระวัง</strong>:</p>
<ul>
<li>ถ้าจะ scale down → สมมติว่า Pod ที่ไม่มี metric ใช้ 100% ของ target</li>
<li>ถ้าจะ scale up → สมมติว่าใช้ 0% ของ target
แบบนี้จะช่วย <strong>ลดความรุนแรงของการ scale ผิด ๆ</strong></li>
</ul>
<p>ถ้ามี Pod ที่ยังไม่ Ready และเรากำลังจะ scale up → ก็สมมติว่า Pod พวกนี้ใช้ 0% เช่นกัน
→ ลดความเสี่ยงการ scale เยอะเกินไป</p>
<p>พอรวมทุกอย่างแล้ว ค่อย <strong>คำนวณ usage ratio ใหม่</strong>
ถ้า ratio ใหม่มันสั่งให้ scale กลับไปทางเดิม หรือใกล้ 1.0 เกินไป → ไม่ scale
แต่ถ้าไม่ใช่ → ค่อย scale ตาม ratio ใหม่</p>
<blockquote>
<p><strong>หมายเหตุ:</strong> ค่า average utilization ที่โชว์ใน HPA status จะไม่เอา not-yet-ready กับ missing metric มารวม (คือยังโชว์ตามค่า raw เดิม)</p>
</blockquote>
<h3 id="ถ้ามีหลาย-metric">ถ้ามีหลาย metric</h3>
<p>ถ้าตั้ง HPA ให้ดู metric หลายอัน มันจะคำนวณแบบนี้ทีละอัน แล้วเลือกจำนวน Pod ที่ต้องการมากที่สุดมาใช้</p>
<p>แต่ถ้า metric บางตัว error หรือดึงมาไม่ได้ → แล้ว metric ที่ได้แนะนำให้ scale down → <strong>จะไม่ scale เลย</strong>
(เพราะไม่มั่นใจ)
แต่ถ้ามี metric ตัวใดตัวหนึ่งที่แนะนำให้ scale up → ก็ scale ได้ตามนั้น</p>
<h3 id="สุดท้ายก่อนจะ-scale-จริง-ๆ">สุดท้ายก่อนจะ scale จริง ๆ</h3>
<p>ก่อนจะ scale จริง HPA จะบันทึกว่า <code>“แนะนำให้ scale เท่าไหร่”</code>
แล้วจะดู recommendation ทั้งหมดในช่วงเวลาหนึ่ง (window ที่ตั้งไว้) แล้วเลือก <strong>ค่าที่สูงที่สุดในช่วงนั้น</strong>
ค่า window นี้ตั้งได้ด้วย <code>--horizontal-pod-autoscaler-downscale-stabilization</code> (default คือ 5 นาที)</p>
<p>→ ช่วยให้ <strong>scale down ค่อย ๆ เป็นค่อย ๆ ไป</strong> ไม่ให้กระตุกขึ้นลงแรง ๆ เวลาค่า metric แกว่ง</p>
<h3 id="ความเสถียรของการ-scale-workload">ความเสถียรของการ scale workload</h3>
<p>เวลาเราจัดการจำนวน replica ด้วย <strong>HorizontalPodAutoscaler</strong> บางครั้งจำนวน Pod อาจจะ <strong>ขึ้น ๆ ลง ๆ ตลอดเวลา</strong> เพราะ metric ที่ใช้มันเปลี่ยนแปลงอยู่เรื่อย ๆ
อาการแบบนี้เรียกว่า <strong>thrashing</strong> หรือ <strong>flapping</strong> ก็ได้ คล้าย ๆ กับแนวคิดที่เรียกว่า <strong>hysteresis</strong> ในโลก cybernetics เลย</p>
<h3 id="การ-autoscale-ระหว่าง-rolling-update">การ autoscale ระหว่าง rolling update</h3>
<p>ใน Kubernetes เราสามารถทำ <strong>rolling update</strong> กับ Deployment ได้
ซึ่งตัว Deployment จะเป็นคนคุม <strong>ReplicaSets</strong> ที่อยู่ข้างใต้ให้เอง</p>
<p>ถ้าเรา config autoscaling ไว้กับ Deployment → เราจะผูก <strong>HorizontalPodAutoscaler</strong> เข้ากับ Deployment ตัวเดียว
จากนั้น HPA จะจัดการกับ field <code>replicas</code> ของ Deployment โดยตรง
พอมี rolling update เกิดขึ้น ตัว deployment controller จะจัดการให้ ReplicaSet รวมกันได้จำนวนที่เหมาะสมระหว่าง rollout และหลัง rollout จบ</p>
<p>แต่ถ้าเป็น <strong>StatefulSet</strong> ที่มี autoscaling → StatefulSet จะ <strong>คุม Pod โดยตรง</strong> ไม่มี ReplicaSet อยู่ตรงกลางแบบ Deployment</p>
<h3 id="รองรับ-resource-metric">รองรับ resource metric</h3>
<p>HPA สามารถ scale ได้ตาม <strong>resource usage ของ Pod</strong> ที่อยู่ใน scope ได้เลย
เวลาเรา define pod spec ต้องระบุ <code>resource requests</code> อย่าง <strong>CPU</strong> กับ <strong>memory</strong> ไว้ด้วยนะ
เพราะข้อมูลนี้ใช้ในการคำนวณ <strong>resource utilization</strong> และใช้เป็นตัวตัดสินใจให้ HPA scale ขึ้นหรือลง</p>
<p>ถ้าจะใช้การ scale แบบอิง utilization ของ resource ก็ต้องตั้ง metric แบบนี้:</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#22863A">type</span><span style="color:#24292E">: </span><span style="color:#032F62">Resource</span></span>
<span class="line"><span style="color:#22863A">resource</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#22863A">  name</span><span style="color:#24292E">: </span><span style="color:#032F62">cpu</span></span>
<span class="line"><span style="color:#22863A">  target</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#22863A">    type</span><span style="color:#24292E">: </span><span style="color:#032F62">Utilization</span></span>
<span class="line"><span style="color:#22863A">    averageUtilization</span><span style="color:#24292E">: </span><span style="color:#005CC5">60</span></span></code></pre>
<p>แบบนี้หมายความว่า HPA จะพยายาม <strong>รักษาค่าเฉลี่ย CPU utilization ของ Pod</strong> ทั้งกลุ่มไว้ที่ 60%
<strong>Utilization = ปริมาณการใช้ resource จริง ÷ resource ที่ขอไว้ (request)</strong>
ดูในหัวข้อ Algorithm จะมีรายละเอียดการคำนวณค่าเฉลี่ยให้</p>
<blockquote>
<p><strong>หมายเหตุ:</strong>
เวลา HPA คำนวณ utilization มันจะ <strong>รวมการใช้ resource ของทุก container ใน Pod เข้าด้วยกัน</strong>
เพราะงั้นตัวเลขสุดท้ายของ Pod อาจไม่สะท้อนการใช้ resource ของ container แต่ละตัวได้ชัดเจน</p>
</blockquote>
<p>ผลคืออาจเกิดเคสแบบนี้ได้:
<strong>container ตัวนึงใช้ resource หนักมาก</strong> แต่พอรวมกับ container อื่น ๆ แล้วค่าเฉลี่ยของทั้ง Pod ยังไม่เกิน threshold → HPA เลยไม่ยอม scale ออก</p>
<h3 id="container-resource-metrics">Container resource metrics</h3>
<p><strong>HorizontalPodAutoscaler (HPA)</strong> ยังรองรับการตั้งค่าแบบ <strong>container metric source</strong> ด้วยนะ
พูดง่าย ๆ ก็คือ HPA สามารถดูการใช้ resource ของ <strong>container แยกแต่ละตัว</strong> ในกลุ่ม Pod ได้เลย เพื่อใช้เป็นตัวตัดสินในการ scale
อันนี้ดีมาก เพราะเราสามารถเลือก track เฉพาะ container ที่สำคัญใน Pod ได้</p>
<p><strong>ตัวอย่าง:</strong>
สมมติเรามี web app อยู่ใน container หลัก และมี sidecar container สำหรับ logging
เราสามารถตั้งให้ HPA <strong>scale ตาม CPU ของ web app container</strong> ได้เลย โดย <strong>ไม่สน</strong> ว่า sidecar ใช้ resource เท่าไหร่</p>
<p>ถ้าเราแก้ resource หลัก (เช่น Deployment) แล้วเพิ่ม container ใหม่เข้าไป
ถ้าอยากให้ container ใหม่นั้นมีผลกับการ scale ด้วย → ก็ต้อง <strong>แก้ HPA spec ด้วย</strong></p>
<p>แต่ถ้า container ที่เราระบุใน metric source</p>
<ul>
<li>ไม่ได้อยู่ใน Pod ทุกตัว (แค่บางตัวมี)</li>
<li>หรือไม่มีอยู่เลยใน Pod ที่รันอยู่บางตัว</li>
</ul>
<p>Pod เหล่านั้นจะถูก <strong>มองข้าม (ignored)</strong> แล้ว HPA จะคำนวณ recommendation ใหม่
ดูรายละเอียดเพิ่มได้ในหัวข้อ Algorithm</p>
<p>ถ้าอยากตั้ง HPA ให้ scale ตาม resource ของ container เฉพาะ ให้ใช้ metric แบบนี้:</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#22863A">type</span><span style="color:#24292E">: </span><span style="color:#032F62">ContainerResource</span></span>
<span class="line"><span style="color:#22863A">containerResource</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#22863A">  name</span><span style="color:#24292E">: </span><span style="color:#032F62">cpu</span></span>
<span class="line"><span style="color:#22863A">  container</span><span style="color:#24292E">: </span><span style="color:#032F62">application</span></span>
<span class="line"><span style="color:#22863A">  target</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#22863A">    type</span><span style="color:#24292E">: </span><span style="color:#032F62">Utilization</span></span>
<span class="line"><span style="color:#22863A">    averageUtilization</span><span style="color:#24292E">: </span><span style="color:#005CC5">60</span></span></code></pre>
<p>ตัวอย่างข้างบน หมายความว่า:
HPA จะพยายาม scale ให้ <strong>CPU utilization ของ container ชื่อ <code>application</code></strong> ในแต่ละ Pod เฉลี่ยอยู่ที่ 60%</p>
<p><strong>หมายเหตุ:</strong></p>
<p>ถ้าเราเปลี่ยนชื่อ container ที่ HPA กำลัง track อยู่
เพื่อให้ระบบยัง scale ได้ลื่น ๆ ระหว่าง rollout ให้ทำตามลำดับนี้:</p>
<ol>
<li>
<p><strong>ก่อน</strong> เปลี่ยนชื่อ container ใน resource หลัก (เช่น Deployment)
→ ไปอัปเดต HPA ก่อน ให้ track ทั้งชื่อใหม่และชื่อเก่าพร้อมกัน</p>
</li>
<li>
<p>พอ rollout เสร็จแล้ว
→ ค่อยไป <strong>ลบชื่อ container เก่า</strong> ออกจาก HPA spec</p>
</li>
</ol>
<h3 id="การตั้งค่าพฤติกรรมการ-scale-configurable-scaling-behavior">การตั้งค่าพฤติกรรมการ scale (Configurable scaling behavior)</h3>
<p>ถ้าใช้ <strong>HorizontalPodAutoscaler API v2</strong> เราจะสามารถใช้ field ที่ชื่อว่า <code>behavior</code> เพื่อกำหนดพฤติกรรมการ <strong>scale ขึ้น (scaleUp)</strong> และ <strong>scale ลง (scaleDown)</strong> แยกกันได้</p>
<p>โดยเราสามารถตั้งค่า <strong>scaling policies</strong> เพื่อควบคุมว่าเวลาจะ scale นั้น <strong>จะเพิ่มหรือลด replica ได้เร็วแค่ไหน</strong>
นอกจากนี้ยังมี 2 ตัวช่วยที่ช่วยลดปัญหา flapping (scale ไปมาเร็วเกิน):</p>
<ul>
<li>การตั้ง <strong>stabilization window</strong> เพื่อให้จำนวน replica เปลี่ยนแบบ smooth</li>
<li>การตั้ง <strong>tolerance</strong> เพื่อมองข้ามความผันผวนของ metric ที่น้อยมาก ๆ</li>
</ul>
<h3 id="scaling-policies">Scaling policies</h3>
<p>ใน <code>behavior</code> สามารถใส่ policy ได้หลายอันเลย
ถ้ามีหลาย policy ระบบจะเลือก policy ที่ <strong>“เปลี่ยนแปลงได้เยอะสุด”</strong> มาใช้โดย default</p>
<p>ตัวอย่าง config นี้สำหรับการ <strong>scaleDown</strong>:</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#22863A">behavior</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#22863A">  scaleDown</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#22863A">    policies</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#24292E">    - </span><span style="color:#22863A">type</span><span style="color:#24292E">: </span><span style="color:#032F62">Pods</span></span>
<span class="line"><span style="color:#22863A">      value</span><span style="color:#24292E">: </span><span style="color:#005CC5">4</span></span>
<span class="line"><span style="color:#22863A">      periodSeconds</span><span style="color:#24292E">: </span><span style="color:#005CC5">60</span></span>
<span class="line"><span style="color:#24292E">    - </span><span style="color:#22863A">type</span><span style="color:#24292E">: </span><span style="color:#032F62">Percent</span></span>
<span class="line"><span style="color:#22863A">      value</span><span style="color:#24292E">: </span><span style="color:#005CC5">10</span></span>
<span class="line"><span style="color:#22863A">      periodSeconds</span><span style="color:#24292E">: </span><span style="color:#005CC5">60</span></span></code></pre>
<ul>
<li><code>periodSeconds</code> หมายถึงระยะเวลาที่ย้อนกลับไปดูว่า policy นี้ยัง valid อยู่ไหม (max = 1800 วินาที = 30 นาที)</li>
<li>policy แรก (Pods) บอกว่า: scale down ได้สูงสุด 4 ตัวต่อนาที</li>
<li>policy ที่สอง (Percent) บอกว่า: scale down ได้ไม่เกิน 10% ของจำนวน Pod ทั้งหมดต่อนาที</li>
</ul>
<p>เช่น ถ้ามี 80 Pods แล้วต้องการ scale ลง →
รอบแรกจะลด 8 ตัว (10%)
รอบต่อไปเหลือ 72 → 10% = 7.2 → ปัดขึ้นเป็น 8
พอจำนวน Pod เหลือ 40 หรือน้อยกว่า → จะเปลี่ยนมาใช้ policy แรก คือ ลดครั้งละ 4 ตัว</p>
<p>ถ้าอยากเปลี่ยนวิธีเลือก policy จาก default (เลือกตัวที่ scale ได้เยอะสุด)
สามารถใช้ field <code>selectPolicy</code> ได้ เช่น:</p>
<ul>
<li><code>Min</code> → เลือก policy ที่เปลี่ยนได้น้อยสุด</li>
<li><code>Disabled</code> → ปิดการ scale สำหรับทิศทางนั้นไปเลย (เช่น scaleDown ไม่ทำ)</li>
</ul>
<h3 id="stabilization-window">Stabilization window</h3>
<p><strong>stabilization window</strong> เอาไว้ช่วยลดอาการ flapping เวลาค่า metric ขึ้น ๆ ลง ๆ เร็วเกินไป
HPA จะใช้ window นี้ในการดูว่า <strong>“สภาพก่อนหน้าที่เหมาะสม”</strong> คืออะไร แล้วพยายามไม่เปลี่ยนแปลงบ่อยโดยไม่จำเป็น</p>
<p>ตัวอย่าง:</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#22863A">behavior</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#22863A">  scaleDown</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#22863A">    stabilizationWindowSeconds</span><span style="color:#24292E">: </span><span style="color:#005CC5">300</span></span></code></pre>
<p>อันนี้หมายถึง ถ้า metric บอกว่าควรจะลด Pod
ระบบจะไปดูว่าในช่วง 5 นาทีที่ผ่านมา (300 วินาที) เคยมีการคำนวณว่าอยากได้กี่ Pod → แล้วเลือกค่าที่สูงที่สุดในช่วงนั้นมาใช้</p>
<p>หลักการนี้ช่วยให้ระบบ <strong>ไม่ scale ลงเร็วเกิน</strong> แล้วก็ต้อง <strong>สร้างกลับขึ้นมาใหม่อีกทันที</strong> เพราะ metric แกว่ง</p>
<h3 id="tolerance-ค่าความผันผวนที่มองข้ามได้">Tolerance (ค่าความผันผวนที่มองข้ามได้)</h3>
<p><code>**tolerance**</code> คือค่า <strong>threshold สำหรับการเปลี่ยนแปลงของ metric</strong> ที่ใช้เป็นเกณฑ์ว่า <strong>จะไม่ scale ถ้าค่าที่เปลี่ยนมันน้อยเกินไป</strong></p>
<p>พูดง่าย ๆ คือ ถ้าค่า metric มันแกว่งเล็กน้อยรอบ ๆ ค่าที่เราตั้งไว้ ระบบจะ <strong>ไม่ scale</strong> เพื่อให้ระบบนิ่งขึ้น ไม่ต้องปรับขึ้นลงบ่อยเกิน</p>
<p>ตัวอย่าง:
ถ้าเราตั้ง HPA ให้ target memory อยู่ที่ <code>100MiB</code> แล้วตั้ง <strong>tolerance ไว้ที่ 5%</strong>:</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#22863A">behavior</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#22863A">  scaleUp</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#22863A">    tolerance</span><span style="color:#24292E">: </span><span style="color:#005CC5">0.05</span><span style="color:#6A737D"> # 5% tolerance สำหรับการ scale ขึ้น</span></span></code></pre>
<p>แบบนี้จะหมายความว่า HPA จะพิจารณา scale <strong>เฉพาะเมื่อการใช้ memory เกิน <code>105MiB</code></strong> (คือ 100 + 5%)</p>
<p>ถ้า <strong>ไม่ตั้งค่า <code>tolerance</code> เอง</strong> ระบบจะใช้ค่า default ทั่วทั้งคลัสเตอร์คือ <strong>10%</strong>
เราสามารถแก้ default นี้ได้โดยใช้ flag:</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1">--horizontal-pod-autoscaler-tolerance</span></span></code></pre>
<p>กับ <code>kube-controller-manager</code> (ตั้งผ่าน API ไม่ได้นะ)</p>
<h3 id="default-behavior">Default Behavior</h3>
<p>เวลาใช้ HPA แบบ custom ไม่จำเป็นต้องตั้งทุก field ก็ได้
ตั้งเฉพาะค่าที่อยากปรับ ค่าอื่น ๆ จะใช้ default เดิมจาก HPA algorithm</p>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#22863A">behavior</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#22863A">  scaleDown</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#22863A">    stabilizationWindowSeconds</span><span style="color:#24292E">: </span><span style="color:#005CC5">300</span></span>
<span class="line"><span style="color:#22863A">    policies</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#24292E">    - </span><span style="color:#22863A">type</span><span style="color:#24292E">: </span><span style="color:#032F62">Percent</span></span>
<span class="line"><span style="color:#22863A">      value</span><span style="color:#24292E">: </span><span style="color:#005CC5">100</span></span>
<span class="line"><span style="color:#22863A">      periodSeconds</span><span style="color:#24292E">: </span><span style="color:#005CC5">15</span></span>
<span class="line"><span style="color:#22863A">  scaleUp</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#22863A">    stabilizationWindowSeconds</span><span style="color:#24292E">: </span><span style="color:#005CC5">0</span></span>
<span class="line"><span style="color:#22863A">    policies</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#24292E">    - </span><span style="color:#22863A">type</span><span style="color:#24292E">: </span><span style="color:#032F62">Percent</span></span>
<span class="line"><span style="color:#22863A">      value</span><span style="color:#24292E">: </span><span style="color:#005CC5">100</span></span>
<span class="line"><span style="color:#22863A">      periodSeconds</span><span style="color:#24292E">: </span><span style="color:#005CC5">15</span></span>
<span class="line"><span style="color:#24292E">    - </span><span style="color:#22863A">type</span><span style="color:#24292E">: </span><span style="color:#032F62">Pods</span></span>
<span class="line"><span style="color:#22863A">      value</span><span style="color:#24292E">: </span><span style="color:#005CC5">4</span></span>
<span class="line"><span style="color:#22863A">      periodSeconds</span><span style="color:#24292E">: </span><span style="color:#005CC5">15</span></span>
<span class="line"><span style="color:#22863A">    selectPolicy</span><span style="color:#24292E">: </span><span style="color:#032F62">Max</span></span></code></pre>
<ul>
<li>
<p>scale down: window = 300 วินาที (หรือใช้ค่าจาก <code>--horizontal-pod-autoscaler-downscale-stabilization</code> ก็ได้)
และ policy บอกว่า scale down ได้ 100% → หมายถึงลดได้จนถึงจำนวนขั้นต่ำที่อนุญาต</p>
</li>
<li>
<p>scale up: ไม่มี stabilization window → metric มาปุ๊บก็ scale เลย
scale ได้สูงสุด 4 Pods หรือ 100% ทุก ๆ 15 วินาที (แล้วแต่ค่าที่มากกว่า)</p>
</li>
</ul>
<h3 id="ตัวอย่างการ-config-แบบต่าง-ๆ"><strong>ตัวอย่างการ config แบบต่าง ๆ</strong></h3>
<ul>
<li>เปลี่ยน stabilization window ของการ scale down ให้เป็น 1 นาที:</li>
</ul>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#22863A">behavior</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#22863A">  scaleDown</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#22863A">    stabilizationWindowSeconds</span><span style="color:#24292E">: </span><span style="color:#005CC5">60</span></span></code></pre>
<ul>
<li>จำกัด rate การ scale down ไม่ให้เกิน 10% ต่อนาที:</li>
</ul>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#22863A">behavior</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#22863A">  scaleDown</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#22863A">    policies</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#24292E">    - </span><span style="color:#22863A">type</span><span style="color:#24292E">: </span><span style="color:#032F62">Percent</span></span>
<span class="line"><span style="color:#22863A">      value</span><span style="color:#24292E">: </span><span style="color:#005CC5">10</span></span>
<span class="line"><span style="color:#22863A">      periodSeconds</span><span style="color:#24292E">: </span><span style="color:#005CC5">60</span></span></code></pre>
<ul>
<li>จำกัดการลดไม่ให้เกิน 5 Pods ต่อนาที และเลือก policy ที่ลดได้น้อยที่สุด:</li>
</ul>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#22863A">behavior</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#22863A">  scaleDown</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#22863A">    policies</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#24292E">    - </span><span style="color:#22863A">type</span><span style="color:#24292E">: </span><span style="color:#032F62">Percent</span></span>
<span class="line"><span style="color:#22863A">      value</span><span style="color:#24292E">: </span><span style="color:#005CC5">10</span></span>
<span class="line"><span style="color:#22863A">      periodSeconds</span><span style="color:#24292E">: </span><span style="color:#005CC5">60</span></span>
<span class="line"><span style="color:#24292E">    - </span><span style="color:#22863A">type</span><span style="color:#24292E">: </span><span style="color:#032F62">Pods</span></span>
<span class="line"><span style="color:#22863A">      value</span><span style="color:#24292E">: </span><span style="color:#005CC5">5</span></span>
<span class="line"><span style="color:#22863A">      periodSeconds</span><span style="color:#24292E">: </span><span style="color:#005CC5">60</span></span>
<span class="line"><span style="color:#22863A">    selectPolicy</span><span style="color:#24292E">: </span><span style="color:#032F62">Min</span></span></code></pre>
<ul>
<li>ปิดการ scale down ไปเลย:</li>
</ul>
<pre class="astro-code github-light" style="background-color:#fff;color:#24292e; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#22863A">behavior</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#22863A">  scaleDown</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#22863A">    selectPolicy</span><span style="color:#24292E">: </span><span style="color:#032F62">Disabled</span></span></code></pre>
<h4 id="references">References:</h4>
<ul>
<li><a href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/#algorithm-details">kubernetes.io</a></li>
<li><a href="https://kubernetes.io/blog/2025/04/28/kubernetes-v1-33-hpa-configurable-tolerance/">kubernetes.io</a></li>
</ul>  </div> </article> </main> <footer data-astro-cid-sz7xmlte>
&copy; 2025 BigJoe. All rights reserved.
<div class="social-links" data-astro-cid-sz7xmlte> <a href="https://www.facebook.com/profile.php?id=61572916280350" target="_blank" data-astro-cid-sz7xmlte> <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" data-astro-cid-sz7xmlte> <path fill="currentColor" d="M13.458 21.696c4.693-.704 8.292-4.753 8.292-9.642c0-5.385-4.365-9.75-9.75-9.75s-9.75 4.365-9.75 9.75c0 4.89 3.599 8.938 8.292 9.642v-6.798h-2.05a.486.486 0 0 1-.486-.486v-1.843c0-.269.218-.486.486-.486h2.05l-.072-1.943c0-.942.175-2.471 1.342-3.307c.816-.583 1.423-.693 2.397-.693c.845 0 1.426.084 1.81.14l.188.025a.193.193 0 0 1 .168.192v2.04c0 .113-.095.2-.205.194h-.038c-.114.004-.71.029-1.216.029c-.89 0-1.458.406-1.458 1.755v1.568h2.192c.3 0 .529.27.48.566l-.28 1.843a.486.486 0 0 1-.479.406h-1.913z" data-astro-cid-sz7xmlte></path> </svg> </a> <a href="https://x.com/joewalker_xyz" target="_blank" data-astro-cid-sz7xmlte> <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" data-astro-cid-sz7xmlte> <g fill="none" fill-rule="evenodd" data-astro-cid-sz7xmlte> <path d="m12.594 23.258l-.012.002l-.071.035l-.02.004l-.014-.004l-.071-.036q-.016-.004-.024.006l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.016-.018m.264-.113l-.014.002l-.184.093l-.01.01l-.003.011l.018.43l.005.012l.008.008l.201.092q.019.005.029-.008l.004-.014l-.034-.614q-.005-.019-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.003-.011l.018-.43l-.003-.012l-.01-.01z" data-astro-cid-sz7xmlte></path> <path fill="currentColor" d="M19.753 4.659a1 1 0 0 0-1.506-1.317l-5.11 5.84L8.8 3.4A1 1 0 0 0 8 3H4a1 1 0 0 0-.8 1.6l6.437 8.582l-5.39 6.16a1 1 0 0 0 1.506 1.317l5.11-5.841L15.2 20.6a1 1 0 0 0 .8.4h4a1 1 0 0 0 .8-1.6l-6.437-8.582l5.39-6.16ZM16.5 19L6 5h1.5L18 19z" data-astro-cid-sz7xmlte></path> </g> </svg> </a> <a href="https://github.com/joeteerawit" target="_blank" data-astro-cid-sz7xmlte> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" data-astro-cid-sz7xmlte><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-sz7xmlte></path></svg> </a> </div> </footer>  <script type="module">const l=window.innerWidth<=720;document.addEventListener("DOMContentLoaded",()=>{const r=t=>{let e=t.parentElement;for(;e;){if(e.tagName==="NAV")return!0;e=e.parentElement}return!1};document.querySelectorAll(".prose p").forEach(t=>{r(t)||t.querySelector("img")&&(t.style.justifyItems="center")}),document.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach(t=>{const e=t;if(r(t))return;const o=t.nextElementSibling,n=o&&o.tagName.toLowerCase()==="pre";l?(e.style.marginTop="1rem",e.style.marginBottom=n?"0":"1rem"):(e.style.marginTop="2rem",e.style.marginBottom=n?"0":"2rem")}),document.querySelectorAll(".diff.remove").forEach(t=>{if(r(t))return;const e=document.createElement("span");e.className="diff-indicator",e.textContent="-",e.style.display="inline-block",e.style.width="15px",e.style.color="#d73a49",e.style.fontWeight="bold",e.style.userSelect="none",t.insertBefore(e,t.firstChild)}),document.querySelectorAll(".diff.add").forEach(t=>{if(r(t))return;const e=document.createElement("span");e.className="diff-indicator",e.textContent="+",e.style.display="inline-block",e.style.width="15px",e.style.color="#22863a",e.style.fontWeight="bold",e.style.userSelect="none",t.insertBefore(e,t.firstChild)}),document.querySelectorAll('a[href^="http"]').forEach(t=>{r(t)||(t.setAttribute("target","_blank"),t.setAttribute("rel","noopener noreferrer"))})});</script> </body></html>